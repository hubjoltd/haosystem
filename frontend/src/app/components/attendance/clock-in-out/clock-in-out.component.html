<div class="time-clock-container">
  <div class="page-header">
    <h1>Time Clock</h1>
    <p class="subtitle">Clock in and out for your shift</p>
  </div>

  <div *ngIf="message" class="alert" [class.success]="messageType === 'success'" [class.error]="messageType === 'error'">
    {{ message }}
  </div>

  <div class="main-content">
    <div class="left-panel">
      <div class="date-time-card">
        <div class="calendar-icon">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="date-display">{{ formatDate(currentTime) }}</div>
        <div class="time-label">Current Time</div>
        <div class="time-display">{{ formatTime(currentTime) }}</div>
      </div>

      <div class="employee-section">
        <div class="section-label">
          <i class="fas fa-user"></i>
          <span>Select Employee</span>
        </div>
        
        <select [(ngModel)]="selectedEmployeeId" (ngModelChange)="onEmployeeChange()" class="employee-select" [disabled]="loadingEmployees">
          <option [ngValue]="null" *ngIf="loadingEmployees">Loading employees...</option>
          <option [ngValue]="null" *ngIf="!loadingEmployees">-- Select Employee --</option>
          <option *ngFor="let emp of employees" [ngValue]="emp.id">
            {{ emp.firstName }} {{ emp.lastName }}
          </option>
        </select>

        <div class="selected-employee-card" *ngIf="selectedEmployee">
          <div class="employee-avatar">{{ getEmployeeInitials(selectedEmployee) }}</div>
          <div class="employee-info">
            <span class="employee-name">{{ selectedEmployee.firstName }} {{ selectedEmployee.lastName }}</span>
            <span class="employee-role">{{ selectedEmployee.designation?.title || selectedEmployee.jobRole?.title || 'Employee' }}</span>
          </div>
        </div>

        <div class="time-info" *ngIf="selectedEmployee">
          <div class="time-row">
            <span class="label">Clock In:</span>
            <span class="value">{{ todayRecord?.clockIn || '--:--' }}</span>
          </div>
          <div class="time-row">
            <span class="label">Clock Out:</span>
            <span class="value">{{ todayRecord?.clockOut || '—' }}</span>
          </div>
          <div class="time-row">
            <span class="label"><i class="fas fa-clock"></i> Break:</span>
            <span class="value">30min</span>
          </div>
        </div>

        <div class="clock-buttons">
          <button class="btn-clock-in" (click)="clockIn()" [disabled]="loadingClockIn || loadingClockOut || loadingRecord || !selectedEmployeeId || isClockedIn()">
            <i class="fas fa-sign-in-alt" *ngIf="!loadingClockIn"></i>
            <i class="fas fa-spinner fa-spin" *ngIf="loadingClockIn"></i>
            <span>Clock In</span>
          </button>
          <button class="btn-clock-out" (click)="clockOut()" [disabled]="loadingClockIn || loadingClockOut || loadingRecord || !selectedEmployeeId || !isClockedIn()">
            <i class="fas fa-sign-out-alt" *ngIf="!loadingClockOut"></i>
            <i class="fas fa-spinner fa-spin" *ngIf="loadingClockOut"></i>
            <span>Clock Out</span>
          </button>
        </div>
      </div>
    </div>

    <div class="right-panel">
      <div class="activity-section">
        <div class="section-label">
          <i class="fas fa-clock"></i>
          <span>Today's Activity</span>
        </div>

        <div class="activity-list" *ngIf="todayActivities.length > 0">
          <div class="activity-item" *ngFor="let record of todayActivities" [class.active]="record.clockIn && !record.clockOut">
            <div class="activity-avatar">{{ getEmployeeInitials(record) }}</div>
            <div class="activity-details">
              <span class="activity-name">{{ getEmployeeName(record) }}</span>
              <div class="activity-times">
                <span class="time-in"><i class="fas fa-arrow-right"></i> {{ record.clockIn || '-' }}</span>
                <span class="time-out"><i class="fas fa-arrow-left"></i> {{ record.clockOut || '—' }}</span>
                <span class="duration"><i class="fas fa-sync-alt"></i> 30min</span>
              </div>
            </div>
            <div class="activity-status" [class.completed]="record.clockOut" [class.active-badge]="record.clockIn && !record.clockOut">
              {{ record.clockOut ? 'Completed' : 'Active' }}
            </div>
          </div>
        </div>

        <div class="no-activity" *ngIf="todayActivities.length === 0">
          <i class="fas fa-calendar-times"></i>
          <p>No activity recorded today</p>
        </div>
      </div>
    </div>
  </div>
</div>
