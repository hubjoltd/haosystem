<aside class="sidebar" [class.collapsed]="collapsed" [class.mobile-open]="mobileOpen">
  <div class="sidebar-header">
    <div class="logo">
      <i class="fas fa-cube"></i>
      <span class="logo-text">{{ 'app.title' | translate }}</span>
    </div>
  </div>

  <nav class="sidebar-nav">
    <ul class="nav-list">
      <ng-container *ngFor="let item of menuItems">
        <ng-container *ngTemplateOutlet="menuItemTemplate; context: { $implicit: item, level: 0, parentItems: menuItems }"></ng-container>
      </ng-container>
    </ul>
  </nav>

  <div class="sidebar-footer">
    <a class="logout-btn" (click)="logout()" [title]="'app.logout' | translate">
      <i class="fas fa-sign-out-alt"></i>
      <span class="logout-text">{{ 'app.logout' | translate }}</span>
    </a>
  </div>
</aside>

<ng-template #menuItemTemplate let-item let-level="level" let-parentItems="parentItems">
  <li class="nav-item" 
      [class.active]="isActive(item.route)" 
      [class.has-active-child]="hasActiveChild(item)"
      [style.padding-left.px]="level > 0 ? level * 12 : 0">
    <a class="nav-link" (click)="toggleMenu(item, parentItems)" [title]="item.labelKey ? (item.labelKey | translate) : item.label">
      <i [class]="item.icon"></i>
      <span class="nav-text">{{ item.labelKey ? (item.labelKey | translate) : item.label }}</span>
      <i *ngIf="item.children && item.children.length > 0" 
         class="fas fa-chevron-down expand-icon" 
         [class.rotated]="item.expanded"></i>
    </a>
    
    <ul class="sub-menu" [class.nested]="level > 0" *ngIf="item.children && item.children.length > 0 && item.expanded">
      <ng-container *ngFor="let child of item.children">
        <ng-container *ngTemplateOutlet="menuItemTemplate; context: { $implicit: child, level: level + 1, parentItems: item.children }"></ng-container>
      </ng-container>
    </ul>
  </li>
</ng-template>
