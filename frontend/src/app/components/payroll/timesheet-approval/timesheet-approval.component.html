<div class="attendance-payroll-approval">
  <div class="page-header">
    <div class="header-left">
      <h1>Weekly Timesheets</h1>
      <p class="subtitle">Review employee timesheets and process payroll</p>
    </div>
    <div class="header-actions">
      <input type="date" [(ngModel)]="generateEndDate" class="date-input" />
      <button class="btn btn-outline-primary" (click)="goToStep(3)">
        <i class="fas fa-history"></i> View Payroll History
      </button>
    </div>
  </div>
  
  <div class="timesheet-summary-cards">
    <div class="ts-card blue">
      <span class="ts-card-value">{{ generatedTimesheets.length || 0 }}</span>
      <span class="ts-card-label">Employees</span>
    </div>
    <div class="ts-card yellow">
      <span class="ts-card-value">{{ getTotalRegularHours() }}h</span>
      <span class="ts-card-label">Regular Hours</span>
    </div>
    <div class="ts-card orange">
      <span class="ts-card-value">{{ getTotalOvertimeHours() }}h</span>
      <span class="ts-card-label">OT Hours</span>
    </div>
  </div>
  
  <div class="timesheet-filters">
    <div class="filter-group">
      <label><input type="radio" name="viewMode" value="employee" [(ngModel)]="timesheetViewMode" /> Employee-Wise</label>
      <label><input type="radio" name="viewMode" value="project" [(ngModel)]="timesheetViewMode" /> Project-Wise</label>
    </div>
    <div class="filter-selects">
      <select class="filter-select" [(ngModel)]="filterDepartment">
        <option value="">All Departments</option>
        <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
      </select>
    </div>
  </div>

  <div class="message-bar" *ngIf="message" [ngClass]="messageType">
    {{ message }}
  </div>

  <div class="step-wizard-new">
    <div class="step-item" [class.active]="currentStep === 0" [class.completed]="currentStep > 0" (click)="goToStep(0)">
      <div class="step-circle">
        <i class="fas" [ngClass]="currentStep > 0 ? 'fa-check' : 'fa-file-alt'"></i>
      </div>
      <div class="step-line" [class.completed]="currentStep > 0"></div>
      <div class="step-text">
        <span class="step-title">Generate Payroll</span>
      </div>
    </div>

    <div class="step-item" [class.active]="currentStep === 1" [class.completed]="currentStep > 1" (click)="goToStep(1)">
      <div class="step-circle">
        <i class="fas" [ngClass]="currentStep > 1 ? 'fa-check' : 'fa-calculator'"></i>
      </div>
      <div class="step-line" [class.completed]="currentStep > 1"></div>
      <div class="step-text">
        <span class="step-title">Calculate Payroll</span>
      </div>
    </div>

    <div class="step-item" [class.active]="currentStep === 2" [class.completed]="currentStep > 2" (click)="goToStep(2)">
      <div class="step-circle">
        <i class="fas" [ngClass]="currentStep > 2 ? 'fa-check' : 'fa-play-circle'"></i>
      </div>
      <div class="step-line" [class.completed]="currentStep > 2"></div>
      <div class="step-text">
        <span class="step-title">Process Payroll</span>
      </div>
    </div>

    <div class="step-item" [class.active]="currentStep === 3" (click)="goToStep(3)">
      <div class="step-circle">
        <i class="fas fa-history"></i>
      </div>
      <div class="step-text">
        <span class="step-title">Payroll History</span>
      </div>
    </div>
  </div>

  <!-- Step 1: Generate Payroll -->
  <div class="step-content" *ngIf="currentStep === 0">
    <div class="section-box">
      <div class="step-header">
        <h3>Generate Payroll</h3>
        <p class="period-info">Period: {{ generateStartDate }} - {{ generateEndDate }} ({{ getPayPeriodTypeLabel() }})</p>
      </div>

      <div class="form-grid compact">
        <div class="form-group">
          <label>Pay Period Type</label>
          <select [(ngModel)]="selectedPayPeriodType" (change)="onPayPeriodTypeChange()">
            <option value="MONTHLY">Monthly</option>
            <option value="WEEKLY">Weekly</option>
            <option value="BI_WEEKLY">Bi-Weekly</option>
            <option value="SEMI_MONTHLY">Semi-Monthly</option>
          </select>
        </div>
        <div class="form-group">
          <label>Period Start</label>
          <input type="date" [(ngModel)]="generateStartDate" />
        </div>
        <div class="form-group">
          <label>Period End</label>
          <input type="date" [(ngModel)]="generateEndDate" />
        </div>
        <div class="form-group" style="display: flex; align-items: flex-end;">
          <button class="btn btn-success" [disabled]="generating" (click)="generateTimesheetsForPeriod()">
            <i class="fas fa-sync" [class.fa-spin]="generating"></i>
            {{ generating ? 'Generating...' : 'Generate Payroll' }}
          </button>
        </div>
      </div>

      <div class="sub-section">
        <h4><i class="fas fa-file-alt"></i> Generated Payroll Records</h4>
      </div>

      <div class="loading-indicator" *ngIf="generating">
        <i class="fas fa-spinner fa-spin"></i> Generating payroll from approved attendance...
      </div>

      <div class="table-container" *ngIf="!generating">
        <table class="data-table generated-timesheet-table">
          <thead>
            <tr>
              <th>#</th>
              <th>EMP ID</th>
              <th>FIRST NAME</th>
              <th>LAST NAME</th>
              <th>DEPARTMENT</th>
              <th>REG HOURS</th>
              <th>OT HOURS</th>
              <th>TOTAL HOURS</th>
              <th>STATUS</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let ts of generatedTimesheets; let i = index" [class.processed-row]="isEmployeeAlreadyProcessed(ts.employeeId)">
              <td>{{ i + 1 }}</td>
              <td class="emp-id">{{ ts.employeeCode }}</td>
              <td class="emp-name">{{ ts.firstName }}</td>
              <td class="emp-name">{{ ts.lastName }}</td>
              <td>{{ ts.department }}</td>
              <td class="hours">{{ ts.totalRegularHours.toFixed(1) }}</td>
              <td class="hours">{{ ts.totalOvertimeHours.toFixed(1) }}</td>
              <td class="hours total">{{ ts.totalHours.toFixed(1) }}</td>
              <td>
                <span class="status-badge" [ngClass]="{
                  'approved': !isEmployeeAlreadyProcessed(ts.employeeId),
                  'processed': getEmployeePayrollStatus(ts.employeeId) === 'Processed',
                  'released': getEmployeePayrollStatus(ts.employeeId) === 'Released'
                }">
                  {{ isEmployeeAlreadyProcessed(ts.employeeId) ? getEmployeePayrollStatus(ts.employeeId) : ts.status }}
                </span>
              </td>
              <td class="action-col">
                <button class="btn btn-sm btn-info" (click)="viewTimesheet(ts)" title="View Timesheet">
                  <i class="fas fa-eye"></i> View
                </button>
                <button class="btn btn-sm btn-primary" (click)="downloadTimesheetPDF(ts)" title="Download PDF">
                  <i class="fas fa-file-pdf"></i> PDF
                </button>
              </td>
            </tr>
            <tr *ngIf="generatedTimesheets.length === 0 && !generating">
              <td colspan="10" class="no-data">
                <i class="fas fa-file-alt"></i>
                No payroll records generated yet. Click "Generate Payroll" to create from approved attendance.
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="step-actions-bar">
        <div class="left-actions">
          <span class="selected-info">{{ generatedTimesheets.length }} payroll records generated</span>
        </div>
        <div class="right-actions">
          <button class="btn btn-primary" (click)="goToStep(1)">
            Next: Calculate Payroll <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Individual Timesheet Modal -->
  <div class="modal-overlay" *ngIf="showTimesheetModal">
    <div class="modal-content timesheet-modal" (click)="$event.stopPropagation()">
      <div class="timesheet-document">
        <div class="ts-doc-header">
          <div class="ts-doc-title">
            <h2>EMPLOYEE TIMESHEET</h2>
            <p class="date-range">Date Period: {{ generateStartDate }} - {{ generateEndDate }}</p>
          </div>
          <button class="close-btn-float" (click)="showTimesheetModal = false">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="ts-doc-body">
          <div class="employee-info-card" *ngIf="selectedTimesheetEmployee">
            <h4>Employee Information</h4>
            <div class="info-grid">
              <div class="info-row">
                <span class="info-label">Employee ID:</span>
                <span class="info-value">{{ selectedTimesheetEmployee.employeeCode }}</span>
              </div>
              <div class="info-row">
                <span class="info-label">Employee Name:</span>
                <span class="info-value">{{ selectedTimesheetEmployee.firstName }} {{ selectedTimesheetEmployee.lastName }}</span>
              </div>
              <div class="info-row">
                <span class="info-label">Department:</span>
                <span class="info-value">{{ selectedTimesheetEmployee.department || 'N/A' }}</span>
              </div>
              <div class="info-row">
                <span class="info-label">Designation:</span>
                <span class="info-value">{{ selectedTimesheetEmployee.designation || 'N/A' }}</span>
              </div>
            </div>
          </div>

          <div class="timesheet-data-table">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Day</th>
                  <th>In Time</th>
                  <th>Out Time</th>
                  <th>Reg Hrs</th>
                  <th>OT Hrs</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of individualTimesheetRows" [class.weekend]="row.day === 'Sat' || row.day === 'Sun'">
                  <td>{{ row.date }}</td>
                  <td>{{ row.day }}</td>
                  <td>{{ row.clockIn?.substring(0, 5) || '-' }}</td>
                  <td>{{ row.clockOut?.substring(0, 5) || '-' }}</td>
                  <td class="hours-cell">{{ row.regHours.toFixed(1) }}</td>
                  <td class="hours-cell ot">{{ row.otHours.toFixed(1) }}</td>
                  <td class="hours-cell total">{{ row.totalHours.toFixed(1) }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="ts-summary-section" *ngIf="selectedTimesheetEmployee">
            <div class="summary-title">SUMMARY</div>
            <div class="summary-cards">
              <div class="summary-card blue">
                <span class="card-label">Regular Hours RH</span>
                <span class="card-value">{{ selectedTimesheetEmployee.totalRegularHours.toFixed(1) }}</span>
              </div>
              <div class="summary-card orange">
                <span class="card-label">Overtime Hours OH</span>
                <span class="card-value">{{ selectedTimesheetEmployee.totalOvertimeHours.toFixed(1) }}</span>
              </div>
              <div class="summary-card green">
                <span class="card-label">Total Hours TH</span>
                <span class="card-value">{{ selectedTimesheetEmployee.totalHours.toFixed(1) }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="ts-doc-footer">
          <button class="btn btn-outline" (click)="showTimesheetModal = false">Close</button>
          <button class="btn btn-primary" (click)="downloadTimesheetPDF(selectedTimesheetEmployee!)" *ngIf="selectedTimesheetEmployee">
            <i class="fas fa-file-pdf"></i> Download PDF
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 2: Calculate Payroll -->
  <div class="step-content" *ngIf="currentStep === 1">
    <div class="section-box">
      <div class="payroll-summary-cards">
        <div class="payroll-card green">
          <span class="card-label">Total Gross Pay</span>
          <span class="card-value">{{ formatCurrency(step3TotalGross) }}</span>
        </div>
        <div class="payroll-card red">
          <span class="card-label">Total Taxes</span>
          <span class="card-value">{{ formatCurrency(step3TotalTax) }}</span>
        </div>
        <div class="payroll-card blue">
          <span class="card-label">Total Net Pay</span>
          <span class="card-value">{{ formatCurrency(step3TotalNetPay) }}</span>
        </div>
        <div class="payroll-card gray">
          <span class="card-label">Employees</span>
          <span class="card-value">{{ step3EmployeeCount }}</span>
        </div>
      </div>

      <div class="step-header">
        <h3>Calculate Payroll</h3>
        <p class="period-info">Period: {{ generateStartDate && generateEndDate ? generateStartDate + ' - ' + generateEndDate : '-' }}</p>
      </div>

      <div class="loading-indicator" *ngIf="payrollCalcLoading">
        <i class="fas fa-spinner fa-spin"></i> Calculating payroll...
      </div>

      <div class="table-container" *ngIf="!payrollCalcLoading">
        <table class="data-table payroll-calc-table-new">
          <thead>
            <tr>
              <th class="checkbox-col">
                <input type="checkbox" [checked]="allStep3Selected" (change)="toggleAllStep3Selection()" />
              </th>
              <th>S.NO</th>
              <th>EMP ID</th>
              <th>NAME</th>
              <th>TYPE</th>
              <th>HOURS</th>
              <th class="green-header">GROSS</th>
              <th>FEDERAL</th>
              <th>STATE</th>
              <th>SOC.SEC</th>
              <th>MEDICARE</th>
              <th class="red-header">TOTAL TAX</th>
              <th class="green-header">NET PAY</th>
              <th>STATUS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of payrollCalculationRows" [class.selected]="row.selected">
              <td class="checkbox-col">
                <input type="checkbox" [checked]="row.selected" (change)="toggleStep3RowSelection(row)" />
              </td>
              <td>{{ row.sno }}</td>
              <td class="emp-id">{{ row.empId }}</td>
              <td class="emp-name">{{ row.name }}</td>
              <td>{{ row.type }}</td>
              <td>{{ row.hours.toFixed(2) }}h</td>
              <td class="green-text">{{ formatCurrency(row.gross) }}</td>
              <td>{{ formatCurrency(row.federal) }}</td>
              <td>{{ formatCurrency(row.state) }}</td>
              <td>{{ formatCurrency(row.socSec) }}</td>
              <td>{{ formatCurrency(row.medicare) }}</td>
              <td class="red-text">{{ formatCurrency(row.totalTax) }}</td>
              <td class="green-text">{{ formatCurrency(row.netPay) }}</td>
              <td>
                <span class="status-badge" [ngClass]="row.status === 'Calculated' ? 'approved' : 'pending'">
                  {{ row.status }}
                </span>
              </td>
            </tr>
            <tr *ngIf="payrollCalculationRows.length === 0 && !payrollCalcLoading">
              <td colspan="14" class="no-data">
                <i class="fas fa-calculator"></i>
                No payroll data. Generate timesheets first.
              </td>
            </tr>
          </tbody>
          <tfoot *ngIf="payrollCalculationRows.length > 0">
            <tr class="total-row">
              <td></td>
              <td colspan="4" class="text-right"><strong>TOTAL</strong></td>
              <td><strong>{{ step3TotalHours.toFixed(2) }}h</strong></td>
              <td class="green-text"><strong>{{ formatCurrency(step3TotalGross) }}</strong></td>
              <td><strong>{{ formatCurrency(0) }}</strong></td>
              <td><strong>{{ formatCurrency(0) }}</strong></td>
              <td><strong>{{ formatCurrency(0) }}</strong></td>
              <td><strong>{{ formatCurrency(0) }}</strong></td>
              <td class="red-text"><strong>{{ formatCurrency(step3TotalTax) }}</strong></td>
              <td class="green-text"><strong>{{ formatCurrency(step3TotalNetPay) }}</strong></td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="step-actions-bar">
        <div class="left-actions">
          <span class="selected-info">{{ getSelectedStep3Count() }} employee(s) selected</span>
        </div>
        <div class="right-actions">
          <button class="btn btn-outline-secondary" (click)="goToStep(0)">
            Back
          </button>
          <button class="btn btn-primary" (click)="goToStep(2)">
            Next: Process Payroll <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 3: Process Payroll -->
  <div class="step-content" *ngIf="currentStep === 2">
    <div class="section-box">
      <div class="step-header">
        <h3>Process Payroll</h3>
        <p class="period-info">Review and process payroll with pay date</p>
      </div>

      <!-- Pay Date Input -->
      <div class="pay-date-section">
        <div class="form-group pay-date-group">
          <label>Pay Date <span class="required">*</span></label>
          <input type="date" [(ngModel)]="processPayDate" class="pay-date-input" [class.error-border]="showProcessPayDateError">
          <span class="error-message" *ngIf="showProcessPayDateError">Pay date is required to process payroll</span>
        </div>
      </div>

      <div class="payroll-summary-cards">
        <div class="payroll-card green">
          <span class="card-label">Processed Gross</span>
          <span class="card-value">{{ formatCurrency(step4TotalProcessedGross) }}</span>
        </div>
        <div class="payroll-card blue">
          <span class="card-label">Processed Net</span>
          <span class="card-value">{{ formatCurrency(step4TotalProcessedNet) }}</span>
        </div>
        <div class="payroll-card orange">
          <span class="card-label">Hold Gross</span>
          <span class="card-value">{{ formatCurrency(step4TotalHoldGross) }}</span>
        </div>
        <div class="payroll-card gray">
          <span class="card-label">Employees</span>
          <span class="card-value">{{ processedPayrollRows.length + holdPayrollRows.length }}</span>
        </div>
      </div>

      <!-- Processed Payroll Table -->
      <div class="sub-section">
        <h4><i class="fas fa-check-circle text-success"></i> Processed Payroll</h4>
      </div>

      <div class="table-container">
        <table class="data-table payroll-calc-table-new processed-table">
          <thead>
            <tr>
              <th>S.NO</th>
              <th>EMP ID</th>
              <th>NAME</th>
              <th>TYPE</th>
              <th>HOURS</th>
              <th class="green-header">GROSS</th>
              <th>FEDERAL</th>
              <th>STATE</th>
              <th>SOC.SEC</th>
              <th>MEDICARE</th>
              <th class="red-header">TOTAL TAX</th>
              <th class="green-header">NET PAY</th>
              <th>STATUS</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of processedPayrollRows">
              <td>{{ row.sno }}</td>
              <td class="emp-id">{{ row.empId }}</td>
              <td class="emp-name">{{ row.name }}</td>
              <td>{{ row.type }}</td>
              <td>{{ row.hours.toFixed(2) }}h</td>
              <td class="green-text">{{ formatCurrency(row.gross) }}</td>
              <td>{{ formatCurrency(row.federal) }}</td>
              <td>{{ formatCurrency(row.state) }}</td>
              <td>{{ formatCurrency(row.socSec) }}</td>
              <td>{{ formatCurrency(row.medicare) }}</td>
              <td class="red-text">{{ formatCurrency(row.totalTax) }}</td>
              <td class="green-text">{{ formatCurrency(row.netPay) }}</td>
              <td>
                <span class="status-badge processed">{{ row.status }}</span>
              </td>
              <td>
                <div class="btn-group-actions">
                  <button class="btn btn-sm btn-success" (click)="releasePayroll(row)" title="Release to History">
                    <i class="fas fa-check-circle"></i> Release
                  </button>
                  <button class="btn btn-sm btn-warning" (click)="holdPayroll(row)" title="Hold Payroll">
                    <i class="fas fa-pause"></i> Hold
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="processedPayrollRows.length === 0">
              <td colspan="14" class="no-data">
                <i class="fas fa-check-circle"></i>
                No processed payroll records. Process employees from Step 2.
              </td>
            </tr>
          </tbody>
          <tfoot *ngIf="processedPayrollRows.length > 0">
            <tr class="total-row">
              <td colspan="5" class="text-right"><strong>TOTAL</strong></td>
              <td class="green-text"><strong>{{ formatCurrency(step4TotalProcessedGross) }}</strong></td>
              <td colspan="5"></td>
              <td class="green-text"><strong>{{ formatCurrency(step4TotalProcessedNet) }}</strong></td>
              <td>
                <button class="btn btn-sm btn-primary" (click)="releaseAllPayroll()" *ngIf="processedPayrollRows.length > 0" title="Release All to History">
                  <i class="fas fa-paper-plane"></i> Release All
                </button>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>

      <!-- Hold Payroll Table -->
      <div class="sub-section" style="margin-top: 30px;">
        <h4><i class="fas fa-pause-circle text-warning"></i> Hold Payroll</h4>
      </div>

      <div class="table-container">
        <table class="data-table payroll-calc-table-new hold-table">
          <thead>
            <tr>
              <th>S.NO</th>
              <th>EMP ID</th>
              <th>NAME</th>
              <th>TYPE</th>
              <th>HOURS</th>
              <th class="green-header">GROSS</th>
              <th>FEDERAL</th>
              <th>STATE</th>
              <th>SOC.SEC</th>
              <th>MEDICARE</th>
              <th class="red-header">TOTAL TAX</th>
              <th class="green-header">NET PAY</th>
              <th>STATUS</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of holdPayrollRows">
              <td>{{ row.sno }}</td>
              <td class="emp-id">{{ row.empId }}</td>
              <td class="emp-name">{{ row.name }}</td>
              <td>{{ row.type }}</td>
              <td>{{ row.hours.toFixed(2) }}h</td>
              <td class="green-text">{{ formatCurrency(row.gross) }}</td>
              <td>{{ formatCurrency(row.federal) }}</td>
              <td>{{ formatCurrency(row.state) }}</td>
              <td>{{ formatCurrency(row.socSec) }}</td>
              <td>{{ formatCurrency(row.medicare) }}</td>
              <td class="red-text">{{ formatCurrency(row.totalTax) }}</td>
              <td class="green-text">{{ formatCurrency(row.netPay) }}</td>
              <td>
                <span class="status-badge hold">{{ row.status }}</span>
              </td>
              <td>
                <button class="btn btn-sm btn-success" (click)="releaseFromHold(row)" title="Release from Hold">
                  <i class="fas fa-play"></i> Release
                </button>
              </td>
            </tr>
            <tr *ngIf="holdPayrollRows.length === 0">
              <td colspan="14" class="no-data">
                <i class="fas fa-pause-circle"></i>
                No payroll records on hold
              </td>
            </tr>
          </tbody>
          <tfoot *ngIf="holdPayrollRows.length > 0">
            <tr class="total-row">
              <td colspan="5" class="text-right"><strong>TOTAL</strong></td>
              <td class="green-text"><strong>{{ formatCurrency(step4TotalHoldGross) }}</strong></td>
              <td colspan="5"></td>
              <td class="green-text"><strong>{{ formatCurrency(step4TotalHoldNet) }}</strong></td>
              <td colspan="2"></td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="step-actions-bar">
        <div class="left-actions">
          <span class="selected-info">{{ getSelectedStep3Count() }} employee(s) selected for processing</span>
        </div>
        <div class="right-actions">
          <button class="btn btn-outline-secondary" (click)="goToStep(1)">
            Back
          </button>
          <button class="btn btn-success" [disabled]="getSelectedStep3Count() === 0" (click)="processSelectedPayrollWithDate()">
            <i class="fas fa-check-circle"></i> Process Payroll
          </button>
          <button class="btn btn-primary" (click)="goToStep(3)">
            View Payroll History <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Payroll Summary Section after processing -->
  <div class="payroll-summary-section" *ngIf="showPayrollSummary && currentStep === 2">
    <div class="section-box summary-box">
      <div class="summary-header">
        <h3><i class="fas fa-check-circle text-success"></i> Payroll Processed Successfully</h3>
        <button class="btn btn-sm btn-outline" (click)="closeSummary()">
          <i class="fas fa-times"></i> Close
        </button>
      </div>

      <div class="summary-stats">
        <div class="stat-item">
          <span class="stat-value">{{ processedSalariedEmployees.length + processedHourlyEmployees.length }}</span>
          <span class="stat-label">Employees Processed</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ formatCurrency(processedNetTotal) }}</span>
          <span class="stat-label">Net Total Amount</span>
        </div>
      </div>

      <div class="category-section" *ngIf="processedSalariedEmployees.length > 0">
        <h4><i class="fas fa-users"></i> Salaried Employees ({{ processedSalariedEmployees.length }})</h4>
        <table class="data-table summary-table">
          <thead>
            <tr>
              <th>EMP ID</th>
              <th>NAME</th>
              <th>Basic</th>
              <th>Gross</th>
              <th>Taxes</th>
              <th>Net Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let emp of processedSalariedEmployees">
              <td class="emp-id">{{ emp.empId }}</td>
              <td class="emp-name">{{ emp.name }}</td>
              <td>{{ formatCurrency(emp.basic) }}</td>
              <td>{{ formatCurrency(emp.gross) }}</td>
              <td class="tax-col">{{ formatCurrency(emp.taxes) }}</td>
              <td class="net-amount">{{ formatCurrency(emp.netAmount) }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="category-section" *ngIf="processedHourlyEmployees.length > 0">
        <h4><i class="fas fa-clock"></i> Hourly Employees ({{ processedHourlyEmployees.length }})</h4>
        <table class="data-table summary-table">
          <thead>
            <tr>
              <th>EMP ID</th>
              <th>NAME</th>
              <th>Basic</th>
              <th>Gross</th>
              <th>Taxes</th>
              <th>Net Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let emp of processedHourlyEmployees">
              <td class="emp-id">{{ emp.empId }}</td>
              <td class="emp-name">{{ emp.name }}</td>
              <td>{{ formatCurrency(emp.basic) }}</td>
              <td>{{ formatCurrency(emp.gross) }}</td>
              <td class="tax-col">{{ formatCurrency(emp.taxes) }}</td>
              <td class="net-amount">{{ formatCurrency(emp.netAmount) }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="grand-total">
        <span>Grand Total Net Amount:</span>
        <span class="total-value">{{ formatCurrency(processedNetTotal) }}</span>
      </div>
    </div>
  </div>
</div>
