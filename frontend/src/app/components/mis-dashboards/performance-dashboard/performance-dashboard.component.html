<div class="dashboard-container">
  <div class="dashboard-header">
    <div class="header-left">
      <h1><i class="fas fa-chart-line"></i> Performance Dashboard</h1>
      <p class="subtitle">Employee performance analytics and appraisal tracking</p>
    </div>
    <div class="header-actions">
      <select [(ngModel)]="selectedPeriod" class="period-select">
        <option value="quarter">This Quarter</option>
        <option value="year">This Year</option>
      </select>
      <button class="btn-refresh" (click)="loadStats()">
        <i class="fas fa-sync-alt"></i>
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-state">
    <i class="fas fa-spinner fa-spin"></i>
    <span>Loading dashboard...</span>
  </div>

  <div *ngIf="!loading && stats" class="dashboard-content">
    <div class="stats-row">
      <div class="stat-card success">
        <div class="stat-icon"><i class="fas fa-star"></i></div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.highPerformers }}</span>
          <span class="stat-label">High Performers</span>
        </div>
      </div>
      <div class="stat-card primary">
        <div class="stat-icon"><i class="fas fa-trophy"></i></div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.avgPerformanceScore }}/5</span>
          <span class="stat-label">Avg Performance Score</span>
        </div>
      </div>
      <div class="stat-card warning">
        <div class="stat-icon"><i class="fas fa-clock"></i></div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.pendingAppraisals }}</span>
          <span class="stat-label">Pending Appraisals</span>
        </div>
      </div>
      <div class="stat-card info">
        <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.completedAppraisals }}</span>
          <span class="stat-label">Completed Appraisals</span>
        </div>
      </div>
    </div>

    <div class="charts-row two-col">
      <div class="chart-card">
        <div class="card-header">
          <h3><i class="fas fa-medal"></i> Top Performers</h3>
        </div>
        <div class="card-body">
          <div class="top-performers-list">
            <div class="performer-item" *ngFor="let performer of stats.topPerformers; let i = index">
              <div class="rank">{{ i + 1 }}</div>
              <div class="performer-info">
                <div class="performer-avatar">
                  {{ performer.name.charAt(0) }}
                </div>
                <div class="performer-details">
                  <span class="performer-name">{{ performer.name }}</span>
                  <span class="performer-role">{{ performer.designation }} - {{ performer.department }}</span>
                </div>
              </div>
              <div class="performer-score" [style.background]="getScoreColor(performer.score)">
                {{ performer.score }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-card">
        <div class="card-header">
          <h3><i class="fas fa-chart-pie"></i> Performance Distribution</h3>
        </div>
        <div class="card-body">
          <div class="distribution-chart">
            <div class="distribution-item" *ngFor="let item of stats.performanceDistribution">
              <div class="dist-info">
                <span class="dist-dot" [style.background]="getRatingColor(item.rating)"></span>
                <span class="dist-label">{{ item.rating }}</span>
              </div>
              <div class="dist-bar-track">
                <div class="dist-bar-fill" 
                  [style.width.%]="(item.count / getMaxRatingCount()) * 100"
                  [style.background]="getRatingColor(item.rating)"></div>
              </div>
              <span class="dist-count">{{ item.count }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="charts-row two-col">
      <div class="chart-card">
        <div class="card-header">
          <h3><i class="fas fa-chart-area"></i> Appraisal Score Trend</h3>
        </div>
        <div class="card-body">
          <div class="trend-chart">
            <div class="trend-bars">
              <div class="trend-bar" *ngFor="let item of stats.appraisalTrend">
                <div class="bar-container">
                  <div class="bar-fill" [style.height.%]="(item.avgScore / 5) * 100"></div>
                </div>
                <div class="bar-info">
                  <span class="score">{{ item.avgScore }}</span>
                  <span class="quarter">{{ item.quarter }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-card">
        <div class="card-header">
          <h3><i class="fas fa-building"></i> Department Performance</h3>
        </div>
        <div class="card-body">
          <div class="dept-performance">
            <div class="dept-item" *ngFor="let dept of stats.departmentPerformance">
              <span class="dept-name">{{ dept.department }}</span>
              <div class="score-bar-container">
                <div class="score-bar-track">
                  <div class="score-bar-fill" 
                    [style.width.%]="(dept.avgScore / 5) * 100"
                    [style.background]="getScoreColor(dept.avgScore)"></div>
                </div>
                <span class="dept-score" [style.color]="getScoreColor(dept.avgScore)">
                  {{ dept.avgScore }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="chart-card wide">
      <div class="card-header">
        <h3><i class="fas fa-layer-group"></i> Performance by Grade Level</h3>
      </div>
      <div class="card-body">
        <div class="grade-performance">
          <div class="grade-item" *ngFor="let grade of stats.performanceByGrade">
            <div class="grade-bar">
              <div class="grade-fill" [style.height.%]="(grade.avgScore / 5) * 100"
                [style.background]="getScoreColor(grade.avgScore)">
                <span class="grade-score">{{ grade.avgScore }}</span>
              </div>
            </div>
            <span class="grade-label">{{ grade.grade }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
